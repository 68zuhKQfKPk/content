category: Analytics & SIEM
commonfields:
  id: CyberArkIdentity
  version: -1
configuration:
- defaultvalue: https://example.com/
  display: Server URL
  name: url
  required: true
  type: 0
- defaultvalue: oauthsiem
  display: app ID
  name: app_id
  required: true
  type: 0
- display: User name
  additionalinfo: The user name (admin@example.com) and password
  name: credentials
  required: true
  type: 9
- defaultvalue: 3 days
  display: First fetch time (<number> <time unit>, e.g., 12 hours, 1 day, 3 months). default is 3 days.
  name: from
  required: true
  type: 0
- defaultvalue: 100
  display: The maximum number of events per fetch. Default is 100.
  name: limit
  required: true
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: '[Enter a comprehensive, yet concise, description of what the integration does, what use cases it is designed for, etc.]'
display: CyberArkIdentity
name: CyberArkIdentity
script:
  commands:
  - arguments:
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      isArray: false
      name: dummy
      required: true
      secret: false
    deprecated: false
    description: '[Enter a description of the command, including any important information users need to know, for example required permissions.]'
    execution: false
    name: baseintegration-dummy
    outputs:
    - contextPath: BaseIntegration.Output
      description: '[Enter a description of the data returned in this output.]'
      type: String
  isfetchevents: true
  runonce: false
  script: >
    register_module_line('CyberArkIdentity', 'start', __line__())

    # pylint: disable=no-name-in-module

    # pylint: disable=no-self-argument

    import urllib3


    ### GENERATED CODE ###: from SiemApiModule import *  # noqa: E402

    # This code was inserted in place of an API module.

    register_module_line('SiemApiModule', 'start', __line__(), wrapper=-3)

    # pylint: disable=no-name-in-module

    # pylint: disable=no-self-argument


    from abc import ABC

    from typing import Any, Callable, Optional





    from enum import Enum

    from pydantic import BaseConfig, BaseModel, AnyUrl, validator  # type: ignore[E0611, E0611, E0611]

    from requests.auth import HTTPBasicAuth



    class Method(str, Enum):
        GET = 'GET'
        POST = 'POST'
        PUT = 'PUT'
        HEAD = 'HEAD'
        PATCH = 'PATCH'
        DELETE = 'DELETE'


    def load_json(v: Any) -> dict:
        if not isinstance(v, (dict, str)):
            raise ValueError('headers are not dict or a valid json')
        if isinstance(v, str):
            try:
                v = json.loads(v)
                if not isinstance(v, dict):
                    raise ValueError('headers are not from dict type')
            except json.decoder.JSONDecodeError as exc:
                raise ValueError('headers are not valid Json object') from exc
        if isinstance(v, dict):
            return v


    class IntegrationHTTPRequest(BaseModel):
        method: Method
        url: AnyUrl
        verify: bool = True
        headers: dict = dict()  # type: ignore[type-arg]
        auth: Optional[HTTPBasicAuth]
        data: Any = None

        class Config(BaseConfig):
            arbitrary_types_allowed = True

        _normalize_headers = validator('headers', pre=True, allow_reuse=True)(
            load_json
        )


    class Credentials(BaseModel):
        identifier: Optional[str]
        password: str


    def set_authorization(request: IntegrationHTTPRequest, auth_credentials):
        """Automatic authorization.
        Supports {Authorization: Bearer __token__}
        or Basic Auth.
        """
        creds = Credentials.parse_obj(auth_credentials)
        if creds.password and creds.identifier:
            request.auth = HTTPBasicAuth(creds.identifier, creds.password)
        auth = {'Authorization': f'Bearer {creds.password}'}
        if request.headers:
            request.headers |= auth  # type: ignore[assignment, operator]
        else:
            request.headers = auth  # type: ignore[assignment]


    class IntegrationOptions(BaseModel):
        """Add here any option you need to add to the logic"""

        proxy: bool = False
        limit: int = 1000


    class IntegrationEventsClient(ABC):
        def __init__(
            self,
            request: IntegrationHTTPRequest,
            options: IntegrationOptions,
            session=requests.Session(),
        ):
            self.request = request
            self.options = options
            self.session = session
            self._set_proxy()
            self._skip_cert_verification()

        @abstractmethod
        def set_request_filter(self, after: Any):
            """TODO: set the next request's filter.
            Example:
            """
            self.request.headers['after'] = after

        def __del__(self):
            try:
                self.session.close()
            except AttributeError as err:
                demisto.debug(
                    f'ignore exceptions raised due to session not used by the client. {err=}'
                )

        def call(self, request: IntegrationHTTPRequest) -> requests.Response:
            try:
                response = self.session.request(**request.dict())
                response.raise_for_status()
                return response
            except Exception as exc:
                msg = f'something went wrong with the http call {exc}'
                LOG(msg)
                raise DemistoException(msg) from exc

        def _skip_cert_verification(
            self, skip_cert_verification: Callable = skip_cert_verification
        ):
            if not self.request.verify:
                skip_cert_verification()

        def _set_proxy(self):
            if self.options.proxy:
                ensure_proxy_has_http_prefix()
            else:
                skip_proxy()


    class IntegrationGetEvents(ABC):
        def __init__(
            self, client: IntegrationEventsClient, options: IntegrationOptions
        ) -> None:
            self.client = client
            self.options = options

        def run(self):
            stored = []
            for logs in self._iter_events():
                stored.extend(logs)
                if len(stored) >= self.options.limit:
                    return stored[: self.options.limit]
            return stored

        def call(self) -> requests.Response:
            return self.client.call(self.client.request)

        @staticmethod
        @abstractmethod
        def get_last_run(events: list) -> dict:
            """Logic to get the last run from the events
            Example:
            """
            return {'after': events[-1]['created']}

        @abstractmethod
        def _iter_events(self):
            """Create iterators with Yield"""
            pass

    register_module_line('SiemApiModule', 'end', __line__(), wrapper=1)

    ### END GENERATED CODE ###


    urllib3.disable_warnings()


    # -----------------------------------------  GLOBAL VARIABLES  -----------------------------------------

    DATETIME_FORMAT = '%Y-%m-%dT%H:%M:%S.%fZ'



    class CyberArkEventsRequest(IntegrationHTTPRequest):
        method = Method.GET
        headers = {'Accept': '*/*', 'Content-Type': 'application/json'}


    class CyberArkEventsClient(IntegrationEventsClient):
        request: IntegrationHTTPRequest
        options: IntegrationOptions

        def __init__(
            self,
            request: CyberArkEventsRequest,
            options: IntegrationOptions,
            credentials: Credentials,
            session=requests.Session(),
        ) -> None:
            self.access_token = None
            self.credentials = credentials
            super().__init__(request, options, session)

        def set_request_filter(self, after: Any):
            self.request.data = json.dumps({"Script": f"Select ID from Event where WhenOccurred >= '{dateparser.parse('1 week', settings={'TIMEZONE': 'UTC'}).strftime(DATE_FORMAT)}' and WhenOccurred <= '{datetime.now().strftime(DATE_FORMAT)}'"})

        def authenticate(self):
            request = IntegrationHTTPRequest(
                method=self.request.method,
                url=f"{demisto.params().get('url')}/oauth2/token/{demisto.params().get('app_id')}",
                headers={'Authorization': f"Basic {base64.b64encode(f'{self.credentials.identifier}:{self.credentials.password}'.encode()).decode()}"},
                data={'grant_type': 'client_credentials', 'scope': 'siem'},
                verify=not self.request.verify,
            )

            response = self.call(request)
            self.access_token = response.json()['access_token']
            self.request.headers['Authorization'] = f'Bearer {self.access_token}'


    class CyberArkGetEvents(IntegrationGetEvents):
        client: CyberArkEventsClient

        def get_last_run(self: Any, event) -> dict:  # type: ignore
            # The date is in timestamp format and looks like {'WhenOccurred': '/Date(1651483379362)/'}
            last_date = int(dict(event).get('WhenOccurred', '').removesuffix(')/').removeprefix('/Date('))
            last_run = datetime.utcfromtimestamp(last_date / 1000).strftime(DATETIME_FORMAT)

            demisto.debug(f"Getting the last run {last_run}")
            return {'from': last_run}

        def _iter_events(self):
            self.client.authenticate()
            demisto.debug('authenticated successfully')

            result = self.client.call(self.client.request).json()['Result']

            while events := result.get('Results'):
                yield [event.get('Row') for event in events]


    def get_request_params(**kwargs: dict) -> dict:
        fetch_from = kwargs.get('from', '3 days')
        from_day = datetime.strftime(dateparser.parse(fetch_from, settings={'TIMEZONE': 'UTC'}), DATETIME_FORMAT)
        to_day = datetime.strftime(datetime.now(), DATETIME_FORMAT)

        params = {
            'url': f'{kwargs.get("url", "").removesuffix("/")}/RedRock/Query',
            'data': json.dumps({
                "Script": f"Select * from Event where WhenOccurred > '{from_day}' and WhenOccurred <= '{to_day}'"
            }),
            'verify': not kwargs.get('insecure')
        }
        return params


    def main(command: str, demisto_params: dict):
        credentials = Credentials(**demisto_params.get('credentials', {}))
        options = IntegrationOptions(**demisto_params)
        request_params = get_request_params(**demisto_params)
        request = CyberArkEventsRequest(**request_params)
        client = CyberArkEventsClient(request, options, credentials)
        get_events = CyberArkGetEvents(client, options)

        try:
            if command == 'test-module':
                get_events.run()
                demisto.results('ok')

            if command in ('fetch-events', 'CyberArk-get-events'):
                events = get_events.run()
                send_events_to_xsiam(events, vendor='CyberArk', product='Idaptive')

                if events:
                    last_run = get_events.get_last_run(events[-1])
                    demisto.setLastRun(last_run)
                    demisto.debug(f'Set last run to {last_run}')

                    if command == 'CyberArk-fetch-events':
                        CommandResults(
                            readable_output=tableToMarkdown(
                                'CyberArkIdentity RedRock records', events, removeNull=True, headerTransform=pascalToSpace
                            ),
                            raw_response=events,
                        )
                        demisto.results(CommandResults)

        except Exception as e:
            return_error(str(e))


    if __name__ in ('__main__', '__builtin__', 'builtins'):
        # Args is always stronger. Get getIntegrationContext even stronger
        demisto_params_ = demisto.params() | demisto.args() | demisto.getLastRun()
        main(demisto.command(), demisto_params_)

    register_module_line('CyberArkIdentity', 'end', __line__())
  type: python
  subtype: python3
  dockerimage: demisto/fastapi:1.0.0.29406
fromversion: 5.5.0
tests:
- No tests (auto formatted)
image: data:image/png;base64,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
detaileddescription: '[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/cyber-ark-identity)'
